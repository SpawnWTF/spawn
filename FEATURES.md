# Spawn.wtf Feature Tracking

When you add a new feature to the iOS app, update the SDK and SKILL.md to match.

---

## Current Features

### SDK Methods (TypeScript & Python)

| Method | Description | SKILL.md | iOS App |
|--------|-------------|----------|---------|
| `sendText(text)` | Send plain text message | ✅ | ✅ |
| `sendCard(...)` | Send rich card with fields | ✅ | ✅ |
| `updateStatus(status, label)` | Update agent status | ✅ | ✅ |
| `notify(title, body, priority)` | Send push notification | ✅ | ⚠️ Not wired |

### Agent Statuses

| Status | Description | iOS Shows |
|--------|-------------|-----------|
| `online` | Agent connected | ✅ Green dot |
| `idle` | Ready, waiting | ✅ Gray dot |
| `thinking` | Processing | ✅ Pulsing |
| `working` | Doing task | ✅ Progress |
| `error` | Something wrong | ✅ Red dot |
| `offline` | Disconnected | ✅ Gray |

### Message Types (Relay Protocol)

| Type | Direction | Implemented |
|------|-----------|-------------|
| `auth` | Agent → Relay | ✅ |
| `auth_success` | Relay → Agent | ✅ |
| `message` | Both ways | ✅ |
| `status_update` | Agent → Relay | ✅ |
| `agent_status` | Relay → App | ✅ |
| `notification` | Agent → Relay | ✅ |
| `confirmation_request` | Agent → App | ❌ TODO |
| `confirmation_response` | App → Agent | ❌ TODO |
| `agent_spawn_request` | Agent → App | ❌ TODO |
| `agent_spawn_response` | App → Agent | ❌ TODO |

---

## Planned Features (Update SKILL.md when implemented)

### Approval Flows
- [ ] `approval.confirm(title, message, danger_level)` - Request user approval
- [ ] Danger levels: low, medium, high, critical
- [ ] Trade confirmations
- [ ] iOS: Confirmation cards with slide-to-confirm

### Sub-Agent Spawning
- [ ] `agents.request_spawn(...)` - Request to spawn sub-agent
- [ ] Ghost cards in iOS app
- [ ] Auto-spawn modes (off, queue, constrained, trusted)
- [ ] Sub-agent tree visualization

### Policy/Safety
- [ ] `policy.is_path_forbidden(path)` - Check path restrictions
- [ ] `policy.is_allowed(action)` - Check permission
- [ ] iOS: Safety settings panel

### Check-In Protocol
- [ ] `checkin.is_required()` - Check if check-in needed
- [ ] `checkin.request(summary)` - Request user check-in
- [ ] iOS: Check-in notification/modal

---

## How to Add a New Feature

1. **Relay** (`/relay/src/index.ts`)
   - Add new message type handler
   - Update TypeScript types

2. **SDK - TypeScript** (`/sdk/src/agent.ts`)
   - Add new method to SpawnAgent class
   - Export types if needed

3. **SDK - Python** (generated by spawn-skill)
   - Update `getPythonSDK()` in `/spawn-skill/bin/cli.js`
   - Add new async method to SpawnAgent class

4. **SKILL.md** (in spawn-skill)
   - Update `SKILL_MD` constant in `/spawn-skill/bin/cli.js`
   - Document new feature with code examples

5. **iOS App**
   - Handle new message type in WebSocketService
   - Add UI for the feature
   - Update any relevant views

6. **Publish Updates**
   ```bash
   # Bump version in spawn-skill/package.json
   cd spawn-skill && npm publish

   # Push relay changes
   cd relay && npm run deploy
   ```

---

## Files to Update

| Feature Area | Files |
|--------------|-------|
| Protocol | `/relay/src/index.ts` |
| TS SDK | `/sdk/src/agent.ts`, `/sdk/src/types.ts` |
| Python SDK | `/spawn-skill/bin/cli.js` (getPythonSDK) |
| SKILL.md | `/spawn-skill/bin/cli.js` (SKILL_MD const) |
| iOS Messages | `WebSocketService.swift` |
| iOS UI | Various view files |
